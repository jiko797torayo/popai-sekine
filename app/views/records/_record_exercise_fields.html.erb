<div class='nested-fields well well-compact'>
  <div class='form-group'>
    <%= f.hidden_field :exercise_count, class: 'exercise-count' %>
    <%= f.label :part_id %>
    <% part_options = Part.order(:id).map { |p| [p.name, p.id, data: { children_path: part_exercises_path(p) }] } %>
    <%= f.select :part_id, part_options, { include_blank: true }, class: 'select-parent form-control' %>
    <%= f.label :exercise_id %>
    <% exercises = @record.try(:exercises) || [] %>
    <% exercise_options = exercises.map { |e| [e.name, e.id] } %>
    <%= f.select :exercise_id, exercise_options, { include_blank: true }, class: 'select-children form-control' %>

    <%= link_to_remove_association f, class: 'remove-exercise' do %>
      <span>Remove Exercise</span>
    <% end %>
  </div>

  <div id='exercise_details'>
    <%= f.fields_for :exercise_details do |exercise_detail| %>
      <%= render 'exercise_detail_fields', f: exercise_detail %>
    <%end%>
    <div class='links'>
      <%= link_to_add_association f, :exercise_details, class: 'add-exercise-detail' do %>
        <span>Add Exercise Detail</span>
      <% end %>
    </div>
  </div>
</div>
